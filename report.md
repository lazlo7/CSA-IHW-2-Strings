Смагин Максим Сергеевич, БПИ-212

# 4 балла.
В программе используется сочетание клавиш `ctrl+d` для остановки ввода.  
Используется стандарт C11 (`-std=c11`).

Тестовое покрытие:  
|    Ввод       |      prog-c        |      prog-as        |              Комментарий                |
|---------------|--------------------|---------------------|-----------------------------------------|
| aeuioy ;13'+- |   aeuioy ;13'+-    |    aeuioy ;13'+-    | Нет согласных букв - ничего не меняется |
| aeo bdf 10101 |   aeo BDF 10101    |    aeo BDF 10101    |  Все согласные буквы в нижнем регистре  |
| HELLO, WORLD  |    HELLO, WORLD    |     HELLO, WORLD    |  Все согласные буквы в верхнем регистре |
| Tesla Coil 12 |   TeSLa CoiL 12    |    TeSLa CoiL 12    | Есть как верхний, так и нижний регистр  |
| 221930+\_///,[|   221930+\_///,[   |    221930+\_///,[   |                Нет букв                 |
| AEUIOYOOOOEEE |   AEUIOYOOOOEEE    |    AEUIOYOOOOEEE    | Только гласные буквы в верхнем регистре |
| aaeeiioouuyy  |    aaeeiioouuyy    |     aaeeiioouuyy    | Только гласные буквы в нижнем регистре  |

Представленные тесты покрывают как типичные входные данные, так и краевые случаи (нет согласных, все согласные в верхнем регистре, и т. д.).  
Результаты тестов эквивалентны для обеих программ.  
На основании проведенных тестов можно утверждать, что программы работают одинаково корректно.  

Используемые опции компиляции:
- `-masm=intel` для intel синтаксиса
- `-std=c11` используем стандарт C11
- `-fno-asynchronous-unwind-tables` unwind table создается только на границах вызовов
- `-fcf-protection=none` убираем генерацию лишних инструкций, поддерживающих CET (Control Flow Execution)

# 5 баллов.

Используется решение на 4 балла.  
В реализованной программе на C уже используются функции с передачей данных через параметры и локальные переменные.  

При передаче фактических параметров нужно помнить следующие соглашения:
- r(e)ax: возвращаемое значение
- r(e)di: первый аргумент

Напишем комментарии к программе, пользуясь данными соглашениями.  

Так как `char` - целочисленный тип, то, по соглашению, в фукнцию в качестве параметра символ передается в `edi`.  
В программе задействованы только два типа передаваемых в функции аргументов: `char` и `char*` (`const char*` не отличается от `char*` на уровне ассемблера).  
Копирование на стек осуществляется следующим обзразом:  

    mov \<QWORD/DWORD\> PTR -\<offset\>[rbp] \<register\>

Можно заметить, что при передачи аргументов типа `char*` используется `QWORD` (четверное слово), а при передаче аргументов типа `char` используется `DWORD` (двойное слово). Это обусловлено, тем, что `WORD` (машинное слово) состоит из 16 бит в Intel x86, а так как, `char` (в данном случае) использует 32 бита, то ему нужно в два раза больше памяти - `DWORD`. Аналогично, можно заключить, что при передаче `char*` нужно 64 бита памяти, так как используется 64-битная архитектура - `QWORD`.  
При этом `PTR` означает, что значение операнда должно восприниматься как адрес.  

# 6 баллов.
Попробуем максимальное использовать регистры для решения задачи:
- input_string:
    - int i: -4[rbp] -> ebx
    - char c: -5[rbp] -> al
- print_string:
    - int i: -4[rbp] -> ebx
- is_vowel:
    - char c: -4[rbp] -> al
- capitalize_consonants:
    - int i: -4[rbp] -> ebx

Проверим корректность программы с помощью тестов.
Тестовое покрытие:  
|    Ввод       |      prog-c        |      prog-as        |              Комментарий                |
|---------------|--------------------|---------------------|-----------------------------------------|
| aeuioy ;13'+- |   aeuioy ;13'+-    |    aeuioy ;13'+-    | Нет согласных букв - ничего не меняется |
| aeo bdf 10101 |   aeo BDF 10101    |    aeo BDF 10101    |  Все согласные буквы в нижнем регистре  |
| HELLO, WORLD  |    HELLO, WORLD    |     HELLO, WORLD    |  Все согласные буквы в верхнем регистре |
| Tesla Coil 12 |   TeSLa CoiL 12    |    TeSLa CoiL 12    | Есть как верхний, так и нижний регистр  |
| 221930+\_///,[|   221930+\_///,[   |    221930+\_///,[   |                Нет букв                 |
| AEUIOYOOOOEEE |   AEUIOYOOOOEEE    |    AEUIOYOOOOEEE    | Только гласные буквы в верхнем регистре |
| aaeeiioouuyy  |    aaeeiioouuyy    |     aaeeiioouuyy    | Только гласные буквы в нижнем регистре  |

Видно, что результаты тестов эквивалентны результатам тестов, проведенных выше.  
На основании проведенных тестов, можно утверждать, что программа работает корректно.  

Размеры программ:
|   Программа\Размеры  | Число строк кода (SLOC) | Размер исполняемого файла |
|----------------------|-------------------------|---------------------------|
|    Чистая версия     |           197           |         17048 байт        |
| prog.S (мод. версия) |           272           |         16848 байт        |

В сравнении по числу строк кода используем SLOC (Significant Lines Of Code), т. к. в мод. версии есть комментарии и пустые строки.  
Для подсчета SLOC использовалась утилита `cloc`.  
Для получения чистой версии не использовались лишние флаги компиляции, см. `prog-raw` в `./src/Makefile`.
Использование различных флагов, которые убирают макросы и ручной рефакторинг ассемблерного кода позволил сократить SLOC на ~ 28%, при этом изменение размера исполняемого файла незначительно.  